Development of ParFit has been supported in part by the Critical
Materials Institute, an Energy Innovation Hub funded by the U.S
Department of Energy (DOE), Office of Energy Efficiency and Renewable
Energy, Advanced Manufacturing Office, in part by the Chemical Sciences,
Office of Basic Energy Sciences, Office of Science, DOE, and in part by
the Laboratory Directed Research and Development Program, Fundamental
Science Division of the Pacific Northwest National Laboratory.

This file contains the basic information to get started. Refer to
Doc/Manual.pdf for more detailed information.

The main directory, ParFit, contains subdirectories: Data, Doc, ParFit, and
Utils. The Data subdirectory contains the Engine, Games, and ParFit
subdirectories. The Data/Engine directory contains the mmengine input, output,
and parameter files. The Data/Gamess directory contains the QM molecular
information. The Doc subdirectory contains the ParFit user manual. 
The ParFit subdirectory contains the Python scripts and example input
files with root name "dih_scan_inp." ParFit should be run from this directory 
using the command: 

./Parfit.py

The Utils subdirectory contains
an interactive ParFit input generating program (PFinp.py) and template 
scripts that can rename multiple files (rename.py), automatically 
submit multiple jobs on a typical cluster (submit.py) and visualize fit 
using matplotlib (mp2_mm3_OPMMPH.py).

ParFit.py is the main script in the ParFit subdirectory. ParFit 
uses an input file named dih_scan_inp. One can generate an input file using
script PFinp.py with a descriptive name but needs to be copied to dih_scan_inp
before running ParFit. 

The input file has a short and a long format. 

The short format is used for generating a sequence of GAMESS input files 
needed for the ab-initio constrained optimization
of a dihedral-angle energy scan. In this format the input file contains
just one comma-separated line of keywords. The first keyword is 
neccessarily "ginp", the second is "the file-name root", i.e. the name
without ".inp", the third is "the indices of the atoms forming the dihedral
angle", i.e. four numbers defining the dihedral angle and the fourth is "a
triple defining the dihedral angle range", i.e. initial, final, step size.

The long format consists of multiple lines:

 Line/Block       Description
--------------- --------------------------------------------------------------
1 optional      |Two values, "mult", and the number of molecules for which to
                |fit. Example: "mult, Y" where Y is the the number of
                |molecules to use for parameter fitting. If only one molecule,
                |omit this line. 
                |
2 to N          |the full/comp file type, the file-name root, 
                |the atoms forming the dihedral angle, and the triplet defining
                |the dihedral atom: comma separated
                |
                |"the full/comp file type": if "full" all the GAMESS output file
                |in the GAMESS directory, if "comp" the compact form of the same
                |information stored in one file in the GAMESS directory
                |
                |"the file-name root": the name without "***.log" where "***" 
                |is the dihedral angle, if "full", or the name without "scan",
                |if "comp".
                |
                |"the atoms forming the dihedral angle": four numbers defining
                |the dihedral angle
                |
                |"a triple defining the dihedral angle range": initial, final, step 
                |           
N + 1           |The full mmengine path
                |
N + 2           |MM-type: "mm3" or "mmf94"
                |
N + 3           |Optimization algorithm: "ga" or "fmin"
                |
N + 4 to M      |The choice of the parameters to be optimized according to the 
                |following format:
                |line number in add_MM3.prm or add_MMFF94.prm, 'c' or 'p', which
                |stands for "constant" and "parameter" to be optimized, respectively.
                |For example, "15 c c p" means that within line 15, the first and 
                |second parameters will remain constant and only the third parameter 
                |will be optimized.
                |
M + 1 last line |Include "csv_on" to request comma separated value snapshot 
                |files to be printed in the /Data/ParFit subdirectory. The file 
                |contains the relative ab-initio and MM energy for each dihedral 
                |angle. If the file is not needed, use "csv_off". 

Sample inputs can be found in the ParFit subdirectory. The "dih_scan_inp_*_mm3"
are sample inputs for MM3 and "dih_scan_inp_*_mmf94" for MMFF94. (In order to 
use the samples one has to copy any of them to the default input name 
"dih_scan_inp" and the mmengine path must be updated.)
